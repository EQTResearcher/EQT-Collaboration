name: EQT Pipeline Automation
on:
  issues:
    types: [opened, labeled, closed, reopened, assigned]
  pull_request:
    types: [opened, synchronize, closed, review_requested]
  workflow_dispatch:

jobs:
  automate-status:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    
    - name: 自动设置新Issue到🌱新芽
      uses: actions/github-script@v7
      if: github.event.action == 'opened' && github.event.issue.pull_request == null
      with:
        script: |
          await github.rest.projects.createCard({
            column_id: "${{ secrets.SEED_OPTION_ID }}",
            content_type: "Issue",
            content_id: context.issue.id
          });
          await github.rest.issues.update({
            issue_number: context.issue.number,
            owner: context.repo.owner,
            repo: context.repo.repo,
            labels: ['🌱-seed']
          });
          await github.rest.issues.update({
            issue_number: context.issue.number,
            owner: context.repo.owner,
            repo: context.repo.repo,
            body: `## 🎯 EQT研究流程\n\n**当前阶段**: 🌱 新芽\n**优先级**: [请选择]\n**领域**: [请选择]\n**AI需求**: \n**预测**: \n**专家**: \n\n---\n*由 EQT Pipeline 自动创建*`
          });
